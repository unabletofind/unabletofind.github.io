<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Detection Rules - Swetha Devi</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  
  <style>
    :root{
      --bg:#0a0e27; 
      --card:#14182e; 
      --muted:#8b95a5; 
      --accent:#00d9ff; 
      --accent-2:#00a896;
      --text:#e8eef6;
      --border:rgba(255,255,255,0.06);
    }
    
    *{box-sizing:border-box; margin:0; padding:0}
    
    body{
      font-family:'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background:var(--bg);
      color:var(--text);
      line-height:1.7;
      -webkit-font-smoothing:antialiased;
      padding: 20px;
    }
    
    .container{
      max-width:1000px;
      margin:0 auto;
    }
    
    .back-link{
      display:inline-flex;
      align-items:center;
      gap:8px;
      color:var(--accent);
      text-decoration:none;
      margin-bottom:40px;
      padding:10px 0;
    }
    
    .detection-header{
      margin-bottom:40px;
    }
    
    .detection-header h1{
      font-size:36px;
      margin-bottom:16px;
    }
    
    .detection-meta{
      color:var(--muted);
      font-size:15px;
      display:flex;
      gap:20px;
      margin-bottom:20px;
    }
    
    .detection-tags{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    
    .tag{
      background:rgba(0,217,255,0.1);
      border:1px solid rgba(0,217,255,0.2);
      padding:6px 12px;
      border-radius:20px;
      font-size:13px;
      color:var(--accent);
    }
    
    .detection-content{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:16px;
      padding:40px;
      margin-bottom:60px;
    }
    
    .detection-content h2{
      color:var(--accent);
      margin:30px 0 15px;
      font-size:24px;
    }
    
    .detection-content h3{
      color:var(--text);
      margin:25px 0 12px;
      font-size:20px;
    }
    
    .detection-content p{
      margin-bottom:16px;
      color:var(--muted);
    }
    
    .code-block{
      margin:20px 0;
      background:rgba(0,0,0,0.3);
      border-radius:12px;
      overflow:hidden;
      border:1px solid var(--border);
    }
    
    .code-header{
      padding:12px 20px;
      background:rgba(0,0,0,0.4);
      border-bottom:1px solid var(--border);
      font-size:14px;
      color:var(--muted);
    }
    
    pre{
      margin:0;
      padding:20px;
      overflow-x:auto;
    }
    
    @media (max-width: 768px){
      .detection-header h1{
        font-size:28px;
      }
      .detection-content{
        padding:24px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <a href="index.html" class="back-link">
      <i class="fas fa-arrow-left"></i> Back to Home
    </a>
    
    <!-- Detection Rule Template -->
    <article class="detection-rule" id="detection-template" style="display: none;">
      <div class="detection-header">
        <h1>Detection Rule Title</h1>
        <div class="detection-meta">
          <span class="date">Date • Platform</span>
        </div>
        <div class="detection-tags">
          <!-- Tags will be added here -->
        </div>
      </div>
      
      <div class="detection-content">
        <!-- Content will be added here -->
      </div>
    </article>
    
    <!-- Individual Detection Rules will be loaded here -->
    <div id="detection-rules-list"></div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-powershell.min.js"></script>
  <script>
    // Detection Rules Data
    const detectionRulesData = [
      {
        id: "service-installation",
        title: "Sigma: Suspicious Service Installation",
        date: "Feb 10, 2024",
        platform: "Windows",
        tags: ["sigma", "windows", "privilege-escalation", "T1543.003"],
        content: `
          <h2>Rule Description</h2>
          <p>This rule detects suspicious service installations that are often used for persistence and privilege escalation.</p>
          
          <h2>Sigma Rule</h2>
          <div class="code-block">
            <div class="code-header">yaml</div>
            <pre><code class="language-yaml">title: Suspicious Service Installation
id: a1b2c3d4-e5f6-7890-1234-567890abcdef
status: production
description: Detects suspicious service installations
author: Swetha Devi
date: 2024/02/10
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        Image|endswith:
            - '\\sc.exe'
            - '\\powershell.exe'
            - '\\cmd.exe'
        CommandLine|contains:
            - 'create'
            - 'config'
            - 'start'
    filter:
        CommandLine|contains:
            - 'wuauserv'
            - 'bits'
            - 'wscsvc'
    condition: selection and not filter
falsepositives:
    - Legitimate administrative activity
level: high
tags:
    - attack.persistence
    - attack.t1543.003</code></pre>
          </div>
          
          <h2>MITRE ATT&CK Mapping</h2>
          <p><strong>Tactic:</strong> Persistence, Privilege Escalation</p>
          <p><strong>Technique:</strong> T1543.003 - Create or Modify System Process: Windows Service</p>
          
          <h2>Detection Logic</h2>
          <p>This rule looks for:</p>
          <ul>
            <li>Service creation commands (sc.exe create)</li>
            <li>Service configuration changes</li>
            <li>Service start commands from non-standard locations</li>
          </ul>
          
          <h2>Testing</h2>
          <p>Test the rule with:</p>
          <div class="code-block">
            <div class="code-header">powershell</div>
            <pre><code class="language-powershell"># Create a test service
sc.exe create TestService binPath= "C:\\Windows\\System32\\notepad.exe"</code></pre>
          </div>
        `
      },
      {
        id: "ransomware-yara",
        title: "YARA: Ransomware String Patterns",
        date: "Feb 5, 2024",
        platform: "Malware Detection",
        tags: ["yara", "malware", "ransomware", "detection"],
        content: `
          <h2>Rule Description</h2>
          <p>YARA rule set for detecting common ransomware string patterns in binaries and memory.</p>
          
          <h2>YARA Rule</h2>
          <div class="code-block">
            <div class="code-header">yaml</div>
            <pre><code class="language-yaml">rule Ransomware_Common_Patterns {
    meta:
        author = "Swetha Devi"
        date = "2024-02-05"
        description = "Detects common ransomware patterns"
    
    strings:
        $encrypt1 = "AES" wide
        $encrypt2 = "RSA" wide
        $ransom_note = "Your files have been encrypted" wide
        $payment1 = "bitcoin" nocase
        $payment2 = "monero" nocase
        $tor1 = ".onion" wide
        $tor2 = "TOR" wide
        $extension1 = ".locked"
        $extension2 = ".encrypted"
        $extension3 = ".crypted"
    
    condition:
        5 of ($encrypt*) or 
        3 of ($payment*) or 
        2 of ($tor*) or 
        3 of ($extension*) or 
        (filesize < 5MB and 4 of them)
}</code></pre>
          </div>
          
          <h2>Detection Features</h2>
          <ul>
            <li>Encryption algorithm references</li>
            <li>Ransom note patterns</li>
            <li>Cryptocurrency payment instructions</li>
            <li>Tor network references</li>
            <li>Common ransomware file extensions</li>
          </ul>
          
          <h2>Usage</h2>
          <p>Scan files with:</p>
          <div class="code-block">
            <div class="code-header">bash</div>
            <pre><code class="language-bash">yara ransomware_rules.yar suspicious_file.exe</code></pre>
          </div>
        `
      }
    ];

    // Function to display detection rules
    function displayDetectionRules() {
      const container = document.getElementById('detection-rules-list');
      
      detectionRulesData.forEach(rule => {
        const template = document.getElementById('detection-template');
        const ruleElement = template.cloneNode(true);
        ruleElement.id = rule.id;
        ruleElement.style.display = 'block';
        
        ruleElement.querySelector('h1').textContent = rule.title;
        ruleElement.querySelector('.date').textContent = `${rule.date} • ${rule.platform}`;
        
        const tagsContainer = ruleElement.querySelector('.detection-tags');
        rule.tags.forEach(tag => {
          const tagElement = document.createElement('span');
          tagElement.className = 'tag';
          tagElement.textContent = tag;
          tagsContainer.appendChild(tagElement);
        });
        
        ruleElement.querySelector('.detection-content').innerHTML = rule.content;
        container.appendChild(ruleElement);
      });
      
      if (window.Prism) {
        Prism.highlightAll();
      }
    }

    // Initialize based on current page
    if (document.getElementById('detection-rules-list')) {
      displayDetectionRules();
    }
  </script>
</body>
</html>
